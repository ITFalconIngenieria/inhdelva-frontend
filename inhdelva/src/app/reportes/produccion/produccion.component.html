<h4>
    INFORME DE PRODUCCION MENSUAL</h4>
<h5>INSTALACIÓN SOLAR FOTOVOLTAICA INHDELVA, CHOLOMA, HONDURAS.</h5>
<br>
<div class="row" style="width: 76%; margin: auto;">
    <div class="col">
        <table class="table table-sm" style="width: 80%;">
            <tbody>
                <tr>
                    <td class="infoCelda">Proyecto:</td>
                    <td class="dataCelda">INHDELVA</td>
                </tr>
                <tr>
                    <td class="infoCelda">Cliente:</td>
                    <td class="dataCelda">INHDELVA</td>
                </tr>
                <tr>
                    <td class="infoCelda">Potencia Pico total:</td>
                    <td class="dataCelda">4,876.54 kWp</td>
                </tr>
                <tr>
                    <td class="infoCelda">Potencia Nominal total:</td>
                    <td class="dataCelda">4,125.00 kWn</td>
                </tr>
                <tr>
                    <td class="infoCelda">Localidad:</td>
                    <td class="dataCelda">CHOLOMA, HONDURAS.</td>
                </tr>
            </tbody>
        </table>

    </div>
    <div class="col">
        <div>
            <p style="font-size: 16px; color: black; font-weight: bold;"> Fechas: </p>
            <nz-range-picker nzMode="month" [(ngModel)]="fechas"></nz-range-picker>
        </div>
        <br>
        <button nz-button nzType="primary" (click)="consultar()"><i nz-icon nzType="search"></i>Consultar</button>
    </div>
</div>
<hr>
<div>
    <button *ngIf="isVisible" nzTooltipTitle="Exportar a Excel" nz-button style="margin: 1%; background-color: #095f09;" (click)="exportExcel()" nzSize="large" nzTooltipPlacement="topRight" nz-tooltip><i nz-icon nzType="file-excel"></i></button>
    <button *ngIf="isVisible" nzTooltipTitle="Exportar a PDF" nz-button style="margin: 1%; background-color: #f36161;" (click)="exportPdf()" nzSize="large" nzTooltipPlacement="topRight" nz-tooltip><i nz-icon nzType="file-pdf"></i></button>
</div>
<nz-table #nzTable id="produccionTable" *ngIf="isVisible" [nzData]="listOfDataProduccion" nzSize="small" [nzPageSize]="25" [nzScroll]="{y: '350px', x: '6300px' }">
    <thead>
        <tr>
            <th colspan="11" style="background-color: #ffffff;"></th>
            <th colspan="7" style="background-color: #f7d8b8; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black;">
                AHORROS INHDELVA</th>
            <th colspan="4" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black;">
                VERIFICACION GENERACION SOLAR</th>
        </tr>
        <tr>
            <th nzRight="true" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Año de operación</th>
            <th nzRight="true" nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Mes de operación</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Mes calendario</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Año calendario</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Producción total Energía Solar (kWh/mes)</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Energía exportada hacia la red (kWh/mes)</th>
            <th nzWidth="300px" style="background-color: #d7ffd9; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Energía en autoconsumo en INHDELVA (kWh/mes)</th>
            <th nzWidth="300px" style="background-color: #efefef; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Energía consumida de la red (kWh/mes)</th>
            <th nzWidth="300px" style="background-color: #efefef; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Consumo de energía total INHDELVA (kWh/mes)</th>
            <th nzWidth="300px" style="background-color: #d7ffd9; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Fraccion de energía solar en autoconsumo (%)</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Fraccion de energía solar total (%)</th>
            <th nzWidth="300px" style="background-color: #f7d8b8; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Costo de Energia INHDELVA (Lps/kWh)</th>
            <th nzWidth="300px" style="background-color: #f7d8b8; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Energia total INHDELVA (kWh/año)</th>
            <th nzWidth="300px" style="background-color: #f7d8b8; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Costo total de energía INHDELVA (Lps)</th>
            <th nzWidth="300px" style="background-color: #f7d8b8; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Consumo actual de energía de la red (kWh/año)</th>
            <th nzWidth="300px" style="background-color: #f7d8b8; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Costo energía consumida de la red (Lps)</th>
            <th nzWidth="300px" style="background-color: #f7d8b8; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Ahorro en energía por sistema solar (kWh/año)</th>
            <th nzWidth="300px" style="background-color: #f7d8b8; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Ahorro por sistema solar (Lps)</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Producción real Energia Solar (kWh/mes)</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Producción estimada energía solar P50 (kWh/mes)</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Degradacion maxima según garantia de modulos (%)</th>
            <th nzWidth="300px" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid;  border-width: 1px;  color: black;">
                Porcentaje de cumplimiento (%)</th>
        </tr>
    </thead>
    <tbody>
        <ng-container *ngFor="let data of nzTable.data">
            <tr>
                <td nzRight="true" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 239px; " nzAlign="center">{{data.x}}</td>
                <td nzRight="true" style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 240px;" nzAlign="center">{{ data.fecha | date:'M'}}</td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 212px;;" nzAlign="center">{{ data.fecha | date:'MMMM'}}</td>
                <td class="tdGrisOscuro" nzAlign="center">{{ data.fecha | date:'yyyy' }}</td>
                <td class="tdGrisOscuro" nzAlign="center">{{ data.produccionTotalEnergiaSolar | number:'1.2-2':'en_US'}} kWh/mes </td>
                <td class="tdGrisOscuro" nzAlign="center"> {{ data.energiaExportadaHaciaRed | number:'1.2-2':'en_US'}} kWh/mes
                </td>
                <td class="tdVerde" nzAlign="center"> {{ data.energiaAutoconsumoINH | number:'1.2-2':'en_US'}} kWh/mes</td>
                <td class="tdGrisOscuro" nzAlign="center"> {{ data.energiaConsumidaRed | number:'1.2-2':'en_US'}} </td>
                <td class="tdGrisClaro" nzAlign="center"> {{ data.consumoEnergiaTotalINH | number:'1.2-2':'en_US'}} kWh/mes
                </td>
                <td class="tdVerde" nzAlign="center"> {{ data.fraccionEnergiaSolarAutoconsumo * 100 | number:'1.2-2':'en_US'}} %
                </td>
                <td class="tdAzul" nzAlign="center"> {{ data.fraccionEnergiaSolarTotal * 100 | number:'1.2-2':'en_US'}} %</td>
                <td class="tdNaranja" nzAlign="center"> {{ data.costoEnergiaINH | number:'1.4-4':'en_US'}} </td>
                <td class="tdNaranja" nzAlign="center">{{ data.energiaTotalINH | number:'1.2-2':'en_US'}} kWh/mes</td>
                <td class="tdNaranja" nzAlign="center">L {{ data.costoTotalEnergiaINH | number:'1.2-2':'en_US'}}</td>
                <td class="tdNaranja" nzAlign="center">{{ data.consumoActualEnergiaRed | number:'1.2-2':'en_US'}} kWh/mes
                </td>
                <td class="tdNaranja" nzAlign="center">L {{ data.costoEnergiaConsumidaRed | number:'1.2-2':'en_US'}}</td>
                <td class="tdNaranja" nzAlign="center">{{ data.ahorroEnergiaSolar | number:'1.2-2':'en_US'}} kWh/mes</td>
                <td class="tdNaranja" nzAlign="center">L {{ data.ahorroSolar | number:'1.2-2':'en_US'}}</td>
                <td class="tdGrisOscuro" nzAlign="center">{{ data.produccionRealEnergiaSolar | number:'1.2-2':'en_US'}} kWh/mes
                </td>
                <td class="tdGrisOscuro" nzAlign="center">{{ data.produccionEstimadaEnergiaSolar | number:'1.2-2':'en_US'}} kWh/mes
                </td>
                <td class="tdGrisOscuro" nzAlign="center">{{ data.degradacionMaxima * 100 | number:'1.2-2':'en_US'}} %</td>
                <td class="tdGrisOscuro" nzAlign="center">{{ data.porcentajeCumplimiento * 100 | number:'1.2-2':'en_US'}} %</td>
            </tr>
        </ng-container>
        <tr *ngFor="let total of listaTotales">
            <td class="totales" nzAlign="center"> TOTAL </td>
            <td colSpan="3" class="totales" nzAlign="center"> AÑO {{ (total.x) }} </td>
            <td class="totales" nzAlign="center"> {{ total.produccionTotalEnergiaSolar | number:'1.2-2':'en_US'}} kWh/mes
            </td>
            <td class="totales" nzAlign="center"> {{ total.energiaExportadaHaciaRed | number:'1.2-2':'en_US'}} kWh/mes</td>
            <td class="totales" nzAlign="center"> {{ total.energiaAutoconsumoINH | number:'1.2-2':'en_US'}} kWh/mes</td>
            <td class="totales" nzAlign="center"> {{ total.energiaConsumidaRed | number:'1.2-2':'en_US'}} </td>
            <td class="totales" nzAlign="center"> {{ total.consumoEnergiaTotalINH | number:'':'en_US'}} kWh/mes</td>
            <td class="totales" nzAlign="center"> {{ total.fraccionEnergiaSolarAutoconsumo | number:'1.2-2':'en_US'}} %</td>
            <td class="totales" nzAlign="center"> {{ total.fraccionEnergiaSolarTotal | number:'1.2-2':'en_US'}} %</td>
            <td class="totales" nzAlign="center"> {{ total.costoEnergiaINH | number:'1.4-4':'en_US'}} </td>
            <td class="totales" nzAlign="center"> {{ total.energiaTotalINH | number:'1.2-2':'en_US'}} kWh/mes</td>
            <td class="totales" nzAlign="center">L {{ total.costoTotalEnergiaINH | number:'1.2-2':'en_US'}} </td>
            <td class="totales" nzAlign="center"> {{ total.consumoActualEnergiaRed | number:'1.2-2':'en_US'}} kWh/mes</td>
            <td class="totales" nzAlign="center">L {{ total.costoEnergiaConsumidaRed | number:'1.2-2':'en_US'}} </td>
            <td class="totales" nzAlign="center"> {{ total.ahorroEnergiaSolar | number:'1.2-2':'en_US'}} kWh/mes</td>
            <td class="totales" nzAlign="center">L {{ total.ahorroSolar | number:'1.2-2':'en_US'}} </td>
            <td class="totales" nzAlign="center"> {{ total.produccionRealEnergiaSolar | number:'1.2-2':'en_US'}} kWh/mes
            </td>
            <td class="totales" nzAlign="center"> {{ total.produccionEstimadaEnergiaSolar | number:'1.2-2':'en_US'}} kWh/mes
            </td>
            <td class="totales" nzAlign="center"> {{ total.degradacionMaxima | number:'1.2-2':'en_US'}} %</td>
            <td class="totales" nzAlign="center"> {{ total.porcentajeCumplimiento | number:'1.2-2':'en_US'}} %</td>

        </tr>

    </tbody>
</nz-table>
<div *ngIf="!isVisible" style="display: flex; justify-content: center;">
    <img style="width: 50%;" src="assets/Logo-INHDELVA.svg" alt="" srcset="">
</div>
<div>
    <ngx-spinner bdColor="#a4b4d2" size="medium" color="#fff"></ngx-spinner>
</div>