<!-- <nz-table #basicTable [nzData]="listOfData">
    <thead>
        <tr>
            <th>Name</th>
            <th>Age</th>
            <th>Address</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let data of basicTable.data">
            <td></td>
            <td></td>
            <td></td>
            <td>
                <a>Action 一 </a>
                <nz-divider nzType="vertical"></nz-divider>
                <a>Delete</a>
            </td>
        </tr>
    </tbody>
</nz-table>
<br>
<button nz-button (click)="exportPdf()" nzType="primary">PDF</button>
<button nz-button (click)="exportExcel()" nzType="primary">Excel</button> -->
<!-- <br> -->
<h4>RESUMEN DE FACTURACION </h4>
<h5>PARQUE INDUSTRIAL INHDELVA</h5>
<br>
<div class="opciones">
    <div style="margin: 2%;">
        <p style="font-size: 16px; color: black; font-weight: bold;"> Contrato: </p>
        <nz-select [(ngModel)]="contratos" nzPlaceHolder="Seccione uno o varios" nzSize="default" nzMode="multiple" nzPlaceHolder="Please select">
            <nz-option nzLabel="Todos" nzValue="0">
            </nz-option>
            <nz-option *ngFor="let option of listOfContratos" [nzLabel]="option.codigo" [nzValue]="option.id">
            </nz-option>
        </nz-select>
    </div>
    <div style="margin: 2%;">
        <p style="font-size: 16px; color: black; font-weight: bold;"> Fechas: </p>
        <nz-range-picker [(ngModel)]="fechas" (ngModelChange)="onChange($event)"></nz-range-picker>
    </div>
    <div style="width: 100%; margin: auto;">
        <button nz-button nzType="primary" (click)="consultar()"><i nz-icon nzType="search"></i>Consultar</button>
    </div>

</div>
<hr>
<nz-table *ngIf="isVisible" #nzTable [nzPageSize]="25" [nzData]="listOfData" nzSize="small" [nzScroll]="{y: '400px', x: '6000px' }">
    <thead>
        <tr>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 462px;">
                Nave</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 1281px;">
                Empresa</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 616px;">
                Cuenta</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 1420px;">
                Codigo medidor</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Codigo tarifa</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Energia Activa (EA)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Energia reactiva (ER) </th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 140px;">
                Potencia maxima (PM)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Factor potencia (FP)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Fraccion de energia solar en autoocnsumo (FS) </th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Precio base de energia (PBE)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Cargo por energia(CPE)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Promedio potencia 11 meses (P11)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Precio base potencia (PBP)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Cargo por potencia (CPC) </th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Factor de recargo (FR)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Cargo por energia reactiva (CER)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Costo operativo sistema solar (COS)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Costo operativo mantenimiento red de distribucion (COR)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Costo operativo de mantenimiento de equipos auxiliares (COE)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Costos administrativos (COA)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Cargo por costos operativos (CCO)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Punto de medida</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Perdidas internas (PI)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Cargo por perdidas internas (CPI)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Energia activa consumida en Alumbrado Público (EAAP)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Precio de la energia tarifa Alumbrado Público (EAP)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Energía total consumida por los usuarios (ETCU)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Cargo por iluminación comunitaria (CIC)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Energia activa consumida en servicios comunitarios (EASC)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Precio de la energia tarifa Servicio General de Baja Tensión (EBT)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Energía total consumida por los usuarios (ETCU)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                Cargo por servicios comunitarios (CSC)</th>
            <th style="background-color: #c0c0c0; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;">
                CARGOS TOTALES TARIFA</th>
        </tr>
    </thead>
    <tbody>
        <ng-container *ngFor="let data of nzTable.data">
            <tr>
                <td style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 500px;" nzAlign="center"> {{ data.nave }} </td>
                <td style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">{{ data.empresa }}</td>
                <td style="background-color: #aae0ff; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 500px;" nzAlign="center">{{ data.cuenta }}</td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.medidor }} </td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 440px;" nzAlign="center"> {{ data.tarifa }} </td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 495px;" nzAlign="center">{{ data.EA | number:'':'en_US'}} kWh/mes</td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 420px;" nzAlign="center"> {{ data.ER | number:'':'en_US' }} kVArh/mes</td>
                <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">{{ data.PM | number:'':'en_US' }} kW</td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">{{ data.FP | number:'':'en_US' }} </td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">{{ data.FS | number:'':'en_US' }} </td>
                <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 640px;" nzAlign="center">L {{ data.PBE | number:'':'en_US' }} Lps/kWh</td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 520px;" nzAlign="center"> {{ data.CPE | number:'':'en_US' }} Lps</td>
                <td style="background-color: white; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.P11 | number:'':'en_US' }} kW</td>
                <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.PBP | number:'':'en_US' }} Lps/kW-mes</td>
                <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.CPC | number:'':'en_US' }} Lps</td>
                <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ (data.FP
                    < 0.9 && data.FP !==0 ) ? (0.9/data.FP)-1 : 0 | number: '1.2-2': 'en_US' }} ****</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.CER | number:'':'en_US' }} Lps</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">L {{ data.CER | number:'':'en_US' }} *****</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">L {{ data.CER | number:'':'en_US' }} *****</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">L {{ data.CER | number:'':'en_US' }} ******</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">L {{ data.CER | number:'':'en_US' }} *******</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.CCO | number:'':'en_US' }} Lps/kWh</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.PuntoMedida }}</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center">L {{ data.PI | number:'':'en_US' }}</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.CPI | number:'':'en_US' }} Lps</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.EAAP | number:'':'en_US' }} kWh/mes</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.EAP | number:'':'en_US' }}Lps/kWh</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.ETCU | number:'':'en_US' }} kWh/mes</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.CIC | number:'':'en_US' }} Lps/kWh</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.EASC | number:'':'en_US' }} kWh/mes</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.EASC | number:'':'en_US' }} ******</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.ETCU | number:'':'en_US' }} kWh/mes</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.CSC | number:'':'en_US' }} Lps/kWh</td>
                        <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"> {{ data.TOTAL | number:'':'en_US' }} Lps</td>
            </tr>

        </ng-container>
        <!-- <tr>
            <td style="background-color: #dadada; border: rgb(128, 128, 128); border-style: solid; border-width: 1px; color: black; width: 542px;" nzAlign="center"><span style="font-weight: bold; color: black;">PROVEEDOR_1</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 206px;" nzAlign="center" colSpan="2"><span style="font-weight: bold; color: black;">TOTAL</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"><span style="font-weight: bold; color: black;">25,116,000.00 kWh/mes</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 440px;" nzAlign="center"><span style="font-weight: bold; color: black;">25,116,000.00 kWh/mes</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 495px;" nzAlign="center"><span style="font-weight: bold; color: black;">4,563.00 kW</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 420px;" nzAlign="center"><span style="font-weight: bold; color: black;">8,685,300.00 kVArh/mes</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"><span style="font-weight: bold; color: black;">0.95</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"><span style="font-weight: bold; color: black;">-</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 640px;" nzAlign="center"><span style="font-weight: bold; color: black;">-</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 520px;" nzAlign="center"><span style="font-weight: bold; color: black;">L 9,452,086.25</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"><span style="font-weight: bold; color: black;">L 89,113,086.25</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"><span style="font-weight: bold; color: black;">L 7,113,086.25</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"><span style="font-weight: bold; color: black;">L 45,785.25</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"><span style="font-weight: bold; color: black;">L 212,113.25</span></td>
            <td style="background-color: #dadada; border: rgb(121, 121, 121); border-style: solid; border-width: 1px; color: black; width: 900px;" nzAlign="center"><span style="font-weight: bold; color: black;">L 85,478,569.21</span></td>
        </tr> -->
    </tbody>
</nz-table>
<div *ngIf="!isVisible" style="display: flex; justify-content: center;">
    <img style="width: 50%;" src="assets/Logo-INHDELVA.svg" alt="" srcset="">
</div>